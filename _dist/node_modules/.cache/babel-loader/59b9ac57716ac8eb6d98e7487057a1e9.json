{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport Analytics from \"@aws-amplify/analytics\";\nimport { ConsoleLogger as Logger } from \"@aws-amplify/core\";\nimport { DeviceInfos } from \"./DeviceInfos\";\nvar logger = new Logger(\"PinPoint\");\nexport function sendEvent(_x, _x2, _x3, _x4) {\n  return _sendEvent.apply(this, arguments);\n}\n\nfunction _sendEvent() {\n  _sendEvent = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(eventName, params, context, args) {\n    var generated, values;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return endpointGenerated();\n\n          case 3:\n            generated = _context.sent;\n            values = getParamsByContext(eventName, params, context, args);\n            Analytics.record({\n              name: eventName.toString(),\n              attributes: _objectSpread({}, values, generated),\n              immediate: true\n            });\n            _context.next = 11;\n            break;\n\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](0);\n            console.error(_context.t0);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 8]]);\n  }));\n  return _sendEvent.apply(this, arguments);\n}\n\nexport var ZB_EVENT_TYPE = {\n  ZB_APP_INSTALL: \"ZB_APP_INSTALL\",\n  ONEROOM_FILTER_RESULTS: \"ONEROOM_FILTER_RESULTS\",\n  VILLA_FILTER_RESULTS: \"VILLA_FILTER_RESULTS\",\n  OFFICETEL_FILTER_RESULTS: \"OFFICETEL_FILTER_RESULTS\",\n  APART_FILTER_RESULTS: \"APART_FILTER_RESULTS\",\n  ZB_SCREEN_MAP_CLICK: \"ZB_SCREEN_MAP_CLICK\",\n  ZB_GNB_CLICK: \"ZB_GNB_CLICK\",\n  SIGN_UP: \"SIGN_UP\",\n  ZB_SCREEN_CLICK: \"ZB_SCREEN_CLICK\",\n  ZB_SCREEN_VIEW: \"ZB_SCREEN_VIEW\",\n  VIEW_ITEM: \"VIEW_ITEM\",\n  ECOMMERCE_PURCHASE: \"ECOMMERCE_PURCHASE\",\n  ADD_TO_WISHLIST: \"ADD_TO_WISHLIST\",\n  ZB_AD_CLICK: \"ZB_AD_CLICK\",\n  ZB_AD_IMPRESSION: \"ZB_AD_IMPRESSION\",\n  VIEW_SEARCH_RESULTS: \"VIEW_SEARCH_RESULTS\",\n  ZB_WAY_SEARCHING: \"ZB_WAY_SEARCHING\",\n  ZB_VR_MOVING: \"ZB_VR_MOVING\",\n  ZB_VR_LOADING: \"ZB_VR_LOADING\",\n  RN_BUNDLE_INIT: \"RN_BUNDLE_INIT\",\n  CODE_PUSH_CHECK: \"CODE_PUSH_CHECK\",\n  CODE_PUSH_START: \"CODE_PUSH_START\",\n  CODE_PUSH_END: \"CODE_PUSH_END\",\n  APART_PURCHASE: \"APART_PURCHASE\",\n  ZB_AD_PAGE_OPEN: \"ZB_AD_PAGE_OPEN\" // 핀포인트 추가\n\n};\nexport function endpointGenerated() {\n  return _endpointGenerated.apply(this, arguments);\n}\n\nfunction _endpointGenerated() {\n  _endpointGenerated = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2() {\n    var result, _result$, adid, uuid, userAgent, appsflyerId, deviceIP, params, sendParams;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _Promise.all([DeviceInfos.getAdIdObject(), DeviceInfos.getUserAgent(), DeviceInfos.getAppsflyerId(), DeviceInfos.getIpAddress()]);\n\n          case 2:\n            result = _context2.sent;\n            _result$ = result[0], adid = _result$.value, uuid = _result$.uuid;\n            userAgent = result[1];\n            appsflyerId = result[2];\n            deviceIP = result[3];\n            logger.log(\"adId= \", adid, \" uuid= \", uuid, \" appsflyerId= \", appsflyerId, \" userAgent= \", userAgent);\n            params = {\n              appVersion: \"\".concat(DeviceInfos.getVersion()),\n              locale: \"\".concat(DeviceInfos.getDeviceLocale()),\n              make: \"\".concat(DeviceInfos.getBrand()),\n              model: \"\".concat(DeviceInfos.getModel()),\n              modelVersion: \"\".concat(DeviceInfos.getDeviceId()),\n              platform: \"\".concat(DeviceInfos.getSystemName()),\n              platformVersion: \"\".concat(DeviceInfos.getSystemVersion()),\n              timezone: \"\".concat(DeviceInfos.getTimezone()),\n              adId: adid,\n              uuid: uuid,\n              appsflyerId: appsflyerId,\n              deviceIP: deviceIP // userAgent: userAgent\n\n            };\n            sendParams = {};\n\n            _Object$keys(params).forEach(function (key, index) {\n              var value = params[key];\n              if (!!value && value.length > 0) sendParams[key] = value;\n            });\n\n            return _context2.abrupt(\"return\", sendParams);\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _endpointGenerated.apply(this, arguments);\n}\n\nfunction getParamsByContext(eventName, params, context, args) {\n  var result = {};\n\n  _Object$keys(params).forEach(function (key) {\n    var value = getValueByContext(eventName, key, params[key], context, args);\n\n    if (value) {\n      result[key] = value;\n    }\n  });\n\n  return result;\n}\n\nfunction getValueByContext(eventName, key, value, context, args) {\n  var result = null;\n  var error = null;\n\n  if (value === null) {\n    error = new Error(\"eventName: \".concat(eventName, \", key: \").concat(key, \": null value is not allowed in sendEvent param\"));\n  }\n\n  switch (typeof value) {\n    case \"string\":\n      result = value;\n      break;\n\n    case \"number\":\n      {\n        result = \"\".concat(value);\n        break;\n      }\n\n    case \"boolean\":\n      {\n        result = \"\".concat(value);\n        break;\n      }\n\n    case \"function\":\n      if (!!context) {\n        try {\n          var funcResult = value.call(context, context, args);\n          result = getValueByContext(eventName, key, funcResult, context, args);\n        } catch (e) {\n          error = e;\n        }\n      }\n\n      break;\n\n    case \"object\":\n      {\n        error = new Error(\"\\n\\t\\t\\teventName: \".concat(eventName, \", key: \").concat(key, \", value: \").concat(_JSON$stringify(value), \": type object is not allowed in sendEvent param\"));\n        break;\n      }\n\n    case \"symbol\":\n      {\n        error = new Error(\"eventName: \".concat(eventName, \", key: \").concat(key, \", value: \").concat(value.toString(), \": type symbol is not allowed in sendEvent param\"));\n        break;\n      }\n\n    case \"undefined\":\n      {\n        error = new Error(\"eventName: \".concat(eventName, \", key: \").concat(key, \": type undefined is not allowed in sendEvent param\"));\n        break;\n      }\n  }\n\n  if (error) {\n    if (process.env.STAGE === \"prod\") {// Bugsnag.notify(error)\n    } else {\n      console.error(error);\n    }\n  }\n\n  return result;\n}","map":null,"metadata":{},"sourceType":"module"}